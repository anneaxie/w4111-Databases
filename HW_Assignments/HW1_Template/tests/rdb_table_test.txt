/Users/anne/.conda/envs/projects/bin/python "/Users/anne/Documents/Anne/Columbia/third year/databases/projects/HW_Assignments/HW1_Template/tests/rdb_table_tests.py"
Testing load data
DEBUG:root:Executing SQL = select count(*) as count from People
RDB table =  RDBDataTable:
{
  "table_name": "People",
  "connect_info": {
    "host": "localhost",
    "port": 3306,
    "user": "dbuser",
    "password": "dbuserdbuser",
    "db": "lahman2019raw",
    "cursorclass": "<class 'pymysql.cursors.DictCursor'>"
  },
  "key_columns": [
    "playerID"
  ]
}
Number of rows = 19617
First 10 rows =
    playerID birthYear birthMonth birthDay birthCountry birthState     birthCity deathYear  ... weight height bats throws       debut   finalGame   retroID    bbrefID
0  aardsda01      1981         12       27          USA         CO        Denver            ...    215     75    R      R  2004-04-06  2015-08-23  aardd001  aardsda01
1  aaronha01      1934          2        5          USA         AL        Mobile            ...    180     72    R      R  1954-04-13  1976-10-03  aaroh101  aaronha01
2  aaronto01      1939          8        5          USA         AL        Mobile      1984  ...    190     75    R      R  1962-04-10  1971-09-26  aarot101  aaronto01
3   aasedo01      1954          9        8          USA         CA        Orange            ...    190     75    R      R  1977-07-26  1990-10-03  aased001   aasedo01
4   abadan01      1972          8       25          USA         FL    Palm Beach            ...    184     73    L      L  2001-09-10  2006-04-13  abada001   abadan01
5   abadfe01      1985         12       17         D.R.  La Romana     La Romana            ...    220     73    L      L  2010-07-28  2017-10-01  abadf001   abadfe01
6  abadijo01      1850         11        4          USA         PA  Philadelphia      1905  ...    192     72    R      R  1875-04-26  1875-06-10  abadj101  abadijo01
7  abbated01      1877          4       15          USA         PA       Latrobe      1957  ...    170     71    R      R  1897-09-04  1910-09-15  abbae101  abbated01
8  abbeybe01      1869         11       11          USA         VT         Essex      1962  ...    175     71    R      R  1892-06-14  1896-09-23  abbeb101  abbeybe01
9  abbeych01      1866         10       14          USA         NE    Falls City      1926  ...    169     68    L      L  1893-08-16  1897-08-19  abbec101  abbeych01

[10 rows x 24 columns]
Testing find by template
DEBUG:root:Executing SQL = select  playerId,nameLast,nameFirst,birthCity,birthYear  from People  WHERE  nameLast='Williams'AND birthCity='San Diego'
Res =  [
  {
    "playerId": "willite01",
    "nameLast": "Williams",
    "nameFirst": "Ted",
    "birthCity": "San Diego",
    "birthYear": "1918"
  },
  {
    "playerId": "willitr01",
    "nameLast": "Williams",
    "nameFirst": "Trevor",
    "birthCity": "San Diego",
    "birthYear": "1992"
  }
]
Testing find by key
Res =  {
  "playerID": "willite01",
  "teamID": "BOS",
  "yearID": "1960",
  "stint": "1",
  "H": "98",
  "AB": "310"
}
Testing insert works
SQL =  insert into People  (playerID,teamID,USMC)  values(%s,%s,%s)
args =  ['willite01', 'BOS', 'Cool']
Testing insert and delete (by template)
Row to insert =  {'playerID': 'yike', 'nameLast': 'xie', 'nameFirst': 'anne'}
Testing find...
Result of find =  ()
DEBUG:root:Executing SQL = select  playerID,teamID,yearID,stint,H,AB  from Batting  WHERE  playerID='willite01'AND teamID='BOS'AND yearID='1960'AND stint='1'
DEBUG:root:Executing SQL = select  *  from People  WHERE  playerID='yike'
DEBUG:root:Executing SQL = insert into People  (playerID,nameLast,nameFirst)  values('yike','xie','anne')
Doing insert...
Testing find again...
DEBUG:root:Executing SQL = select  *  from People  WHERE  playerID='yike'
Result of find =  [{'playerID': 'yike', 'birthYear': None, 'birthMonth': None, 'birthDay': None, 'birthCountry': None, 'birthState': None, 'birthCity': None, 'deathYear': None, 'deathMonth': None, 'deathDay': None, 'deathCountry': None, 'deathState': None, 'deathCity': None, 'nameFirst': 'anne', 'nameLast': 'xie', 'nameGiven': None, 'weight': None, 'height': None, 'bats': None, 'throws': None, 'debut': None, 'finalGame': None, 'retroID': None, 'bbrefID': None}]
DEBUG:root:Executing SQL = delete from People  WHERE  playerID='yike'
Testing delete...
Delete result =  (1, None)
Testing find again...
DEBUG:root:Executing SQL = select  *  from People  WHERE  playerID='yike'
Result of find =  ()
Testing update works
SQL =  update People  set playerID=%s,birthCountry=%s  WHERE  playerID=%s
Args =  ['yike', 'Neptune', 'willite01']
Testing insert, update, and delete (by template)
Row to insert =  {'playerID': 'yike', 'nameLast': 'xie', 'nameFirst': 'anne'}
Testing find...
DEBUG:root:Executing SQL = select  *  from People  WHERE  playerID='yike'
Result of find =  ()
DEBUG:root:Executing SQL = insert into People  (playerID,nameLast,nameFirst)  values('yike','xie','anne')
Doing insert...
DEBUG:root:Executing SQL = select  *  from People  WHERE  playerID='yike'
Testing find again...
DEBUG:root:Executing SQL = update People  set nameLast='Bonk',birthCountry='Neptune'  WHERE  playerID='yike'
DEBUG:root:Executing SQL = select  *  from People  WHERE  playerID='yike'
DEBUG:root:Executing SQL = delete from People  WHERE  playerID='yike'
Result of find =  [{'playerID': 'yike', 'birthYear': None, 'birthMonth': None, 'birthDay': None, 'birthCountry': None, 'birthState': None, 'birthCity': None, 'deathYear': None, 'deathMonth': None, 'deathDay': None, 'deathCountry': None, 'deathState': None, 'deathCity': None, 'nameFirst': 'anne', 'nameLast': 'xie', 'nameGiven': None, 'weight': None, 'height': None, 'bats': None, 'throws': None, 'debut': None, 'finalGame': None, 'retroID': None, 'bbrefID': None}]
DEBUG:root:Executing SQL = select  *  from People  WHERE  playerID='yike'
Testing update, new result =  {'nameLast': 'Bonk', 'birthCountry': 'Neptune'}
DEBUG:root:Executing SQL = select  playerID,teamID,yearID,stint,H,AB  from Batting  WHERE  playerID='yike'AND teamID='YAY'AND yearID='2019'AND stint='1'
DEBUG:root:Executing SQL = insert into Batting  (playerID,teamID,yearID,stint,H,AB)  values('yike','YAY','2019','1','1','1')
Update result =  (1, None)
Testing find again...
Result of find =  [{'playerID': 'yike', 'birthYear': None, 'birthMonth': None, 'birthDay': None, 'birthCountry': 'Neptune', 'birthState': None, 'birthCity': None, 'deathYear': None, 'deathMonth': None, 'deathDay': None, 'deathCountry': None, 'deathState': None, 'deathCity': None, 'nameFirst': 'anne', 'nameLast': 'Bonk', 'nameGiven': None, 'weight': None, 'height': None, 'bats': None, 'throws': None, 'debut': None, 'finalGame': None, 'retroID': None, 'bbrefID': None}]
Testing delete...
Delete result =  (1, None)
Testing find again...
Result of find =  ()
Testing insert, update, and delete (by key)
Row to insert =  {'playerID': 'yike', 'teamID': 'YAY', 'yearID': '2019', 'stint': '1', 'H': '1', 'AB': '1'}
Testing find...
Result of find =  None
Doing insert...
DEBUG:root:Executing SQL = select  playerID,teamID,yearID,stint,H,AB  from Batting  WHERE  playerID='yike'AND teamID='YAY'AND yearID='2019'AND stint='1'
DEBUG:root:Executing SQL = update Batting  set H='5',AB='10'  WHERE  playerID='yike'AND teamID='YAY'AND yearID='2019'AND stint='1'
Testing find again...
Result of find =  {'playerID': 'yike', 'teamID': 'YAY', 'yearID': '2019', 'stint': '1', 'H': '1', 'AB': '1'}
Testing update, new result =  {'H': '5', 'AB': '10'}
Update result =  1
DEBUG:root:Executing SQL = select  playerID,teamID,yearID,stint,H,AB  from Batting  WHERE  playerID='yike'AND teamID='YAY'AND yearID='2019'AND stint='1'
Testing find again...
DEBUG:root:Executing SQL = delete from Batting  WHERE  playerID='yike'AND teamID='YAY'AND yearID='2019'AND stint='1'
Result of find =  {'playerID': 'yike', 'teamID': 'YAY', 'yearID': '2019', 'stint': '1', 'H': '5', 'AB': '10'}
Testing delete...
Delete result =  1
DEBUG:root:Executing SQL = select  playerID,teamID,yearID,stint,H,AB  from Batting  WHERE  playerID='yike'AND teamID='YAY'AND yearID='2019'AND stint='1'
Testing find again...
Result of find =  None

Process finished with exit code 0
